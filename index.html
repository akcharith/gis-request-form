<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <body>
  <header style=padding: 20px;">
  <img src="CQG Consulting.jpg" alt="Logo" style="height: 50px;">
  </header>
  <title>CQG - GIS Job Request Form</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 10pt;
      padding: 20px;
    }
    .section {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #f9f9f9;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    input[type="text"], select, textarea {
      font-family: Arial, sans-serif;
      font-size: 10pt;
      width: 100%;
      padding: 6px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
    }
    button {
      font-family: Arial, sans-serif;
      font-size: 10pt;
      margin-top: 10px;
      padding: 6px 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
	}
    button:not(.delete-btn) {
      background-color: #0078d4;
      color: white;
	  border: 3px solid black;
    }
    button:not(.delete-btn):hover {
      background-color: #005a9e;
	  border: 3px solid black;
    }
	button.maroon-btn {
	  background-color: rgba(124, 22, 42, 0.75) !important;
	  color: white;
	  border: 1px solid black;
	}
	button.maroon-btn:hover {
	  background-color: rgba(124, 22, 42, 1) !important;
	  border: 1px solid black;
	}
    .delete-btn {
      background-color: transparent;
      color: red;
      border: 1px solid red;
    }
    .delete-btn:hover {
      background-color: rgba(255, 0, 0, 0.1);
    }
    .inline-checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 5px;
    }
    .inline-checkboxes label {
      display: flex;
      align-items: center;
      white-space: nowrap;
    }
    #addButtons {
      margin-top: 20px;
      padding-top: 10px;
      border-top: 2px solid #ddd;
    }
    #submitSection {
      margin-top: 30px;
      border-top: 1px solid #ccc;
      padding-top: 20px;
    }
  </style>
</head>
<body>

<h2 style="color: #7c162a;">GIS Job Request Form</h2>

<label>Project Number</label>
<input type="text" list="projectOptions" id="ranList"/>
<datalist id="projectOptions">
	<option value="11071 Cheetham Salt">
	<option value="11071 Cheetham Salt ERC">
	<option value="11071 Cheetham Salt PRCP">
	<option value="12345 - ArcGISPro - Training">
	<option value="14174 - Walz Construction ESA">
	<option value="15010 Hammock Hill">
	<option value="15022 RGS Rugby Park">
	<option value="15055 LSC">
	<option value="15087 Kershaw Bore Installation">
	<option value="15114 DNRM Bajool EMP">
	<option value="15149 Sugar Terminals">
	<option value="15201 QSL Mourilyan">
	<option value="15201 QSL Mourilyn WQ">
	<option value="15206 Cheetham Stockpile analysis">
	<option value="16004 QSL Townsville">
	<option value="16005 QSL Lucinda">
	<option value="16006 QSL Bundaberg">
	<option value="16007 Mackay QSL">
	<option value="16008 QSL Cairns">
	<option value="16021 RRC_Closed Landfills">
	<option value="16072 QNP">
	<option value="16073 - Stanwell">
	<option value="16077 - NRG Power Station">
	<option value="16085 LSC">
	<option value="16097 - Teys Groundwater Monitoring">
	<option value="16098 GAWB OLS Mapping">
	<option value="16145 Willows">
	<option value="16147 M&P Assessment">
	<option value="16155 - Mt Mackenzie Mine">
	<option value="16184 - SWBTA REMP monitoring">
	<option value="16188 - CHRC Rolleston Landfill">
	<option value="16200 Wilmar Proserpine Sugar">
	<option value="17013 RRC">
	<option value="17016 - CCRC Tully Water Report">
	<option value="17025 - RREMP Request for EOI">
	<option value="17026 - Bundaberg Sugar">
	<option value="17042 - CSE Callide Env Monitoring">
	<option value="17068 - GAWB Cattle Dip Assessment">
	<option value="17144 - Tully Sugar">
	<option value="17165 - GKI Proposed Works">
	<option value="18038 Adani Enivro Support_Fieldwork">
	<option value="18041 Austrak - Noise Monitoring">
	<option value="18050 Qld Govt Cable Assist">
	<option value="18059 MSL Racecourse Mill EE">
	<option value="18067 - RRC LCRL Bird Dispersals">
	<option value="18068 Napco Vegetation Clearing">
	<option value="18072 Hadstone Weather Station">
	<option value="18076 Village National - Styx Mining">
	<option value="18077 Coal Country - Moranbah">
	<option value="18081 Proserpine Sugar Mill">
	<option value="18085 WA Salt">
	<option value="18095 BSC GW monitoring Trap Gully Landfill">
	<option value="18108 - Container Refund Scheme">
	<option value="18122 FBA Bank stabilisation">
	<option value="18125 - BHP GIS">
	<option value="18127 QAL">
	<option value="18138 RRC Igloos Parkhurst">
	<option value="19005 - Okara - MCU Change Appln">
	<option value="19006P - RRC Nature Environment Study">
	<option value="19008 - Saudi Arabia Salt">
	<option value="19009 - Townsville Flood Cleanup">
	<option value="19012 - Incitec Pivot Contam Land NM">
	<option value="19013 - Curragh REMP 2019">
	<option value="19019 - Grays Online Soil Testing">
	<option value="19022 - Mt Chalmers">
	<option value="19030 - Clermont Solar">
	<option value="19039 - RRC LCRL Geotech">
	<option value="19045 - BBST Dust Assessment">
	<option value="19046 - RRC LCRLF Annual Volumetric Survey">
	<option value="19048 - PDS SWBTA General Works -Tunuba (now project 20007)">
	<option value="19049 - Vassallo - Sarina Nth Access">
	<option value="19052 - ASMTI Early Works">
	<option value="19055P - Gemco Rail">
	<option value="19057 - Fitzroy Australia Resources">
	<option value="19058 - RRC EMP Advice Dale Park Pits and Quarries">
	<option value="19059 - RRC West ROK Aquaculture Soil Investigation">
	<option value="19070 - Mackay RC Soil Testing">
	<option value="19072 - Anglo American">
	<option value="19074 - Balacalava Island">
	<option value="19075 - Prospect Street">
	<option value="19077 - QAL">
	<option value="19083 - GPC Baseline Contamination Assessment SMIT">
	<option value="19084 - Carpentaria Gold WTS">
	<option value="19089 - GPC Ticor Quarry">
	<option value="19090 - Thiess Berm Compliance script">
	<option value="19098 - Lakes Ck Rd - Vassallo Enviro Representative">
	<option value="19100 (now 20142) - Lendlease Rookwood Weir">
	<option value="19107 - Premise Veg Management Plan">
	<option value="19111 - Curtis Island Quarry Sites">
	<option value="19112 - Parkhurst State School">
	<option value="19115 - GRC - Phillip St EMR">
	<option value="19118 - Fitzroy Basin Association SW Event Sampling">
	<option value="19123 - Whitsunday Green Creek Works">
	<option value="19124 - Gracemere Landfill monitoring bores">
	<option value="19125 - IRC Premise Nebo Irrigation Area">
	<option value="19126 - GRC - Biodiversity Survey">
	<option value="19127 - Gladstone-Monto Road Floodway restoration - ESCP">
	<option value="19133 - QPWS-DES Weed Management Keppel Sands">
	<option value="20001 - Tunuba Delineation Fencing">
	<option value="20002 - M and P Services - Baseline Assessment">
	<option value="20007 - Tunuba Conrad Gargett Boat Ramp">
	<option value="20011 - Tunuba Traffic Management">
	<option value="20020 - AECOM Bush Hut Ecology Survey">
	<option value="20028 - TTPH - Baseline Soil Assessment">
	<option value="20032 - Urbex East Point Development">
	<option value="20038 - Port Alma Road Widening">
	<option value="20039 - Rookwood Weir Noise Monitoring">
	<option value="20047 - Fencing at UOTF ASMTI">
	<option value="20059 - Anglo BHP Peabody Moranbah Collaborative Post-Mining Land-use Baseline Study">
	<option value="20059P - Anglo BHP Peabody Moranbah Collaborative Post-Mining Land-use Baseline Study">
	<option value="20064 - Tunuba Mt Etna Weeds">
	<option value="20070 - SWBTA Quarry EMP Barlows Earth Moving">
	<option value="20076 - Sojitz Weed Spraying">
	<option value="20078 - Tunuba DFKG Quarry Investigations">
	<option value="20080 - CCRC - Tully Landfill">
	<option value="20082 - Ramboll site assessment">
	<option value="20106 - Grant Thornton Musgrave St">
	<option value="20112 - Project Pioneer Water Quality Survey">
	<option value="20115 - Rods Bay Solar">
	<option value="20116 - Biodiversity Management Plan - The Caves and Palm Tree Quarry">
	<option value="20118 - Alpha HPA - Yarwun">
	<option value="20132 - Adani - Mine Access Road realignment">
	<option value="20133 - MRC Mirani Baseline Soil Assessment">
	<option value="20135 - CQU Contam EMR">
	<option value="20136 - Riverview Veg Assessment">
	<option value="20139 - Acciona Rookwood FSC">
	<option value="20142 - Lendlease Rookwood Weir">
	<option value="20144 - Greenvale GVTA Firebreaks and Fencelines">
	<option value="20145 - Tununba QPWS Zamia Walking Track">
	<option value="20155 - IRC Nebo Soil Salinity">
	<option value="20157 - Weed spraying Capricorn Coast">
	<option value="20158 - FDC - CQU School of Manufacturing">
	<option value="20161 - Flaggy Creek Environmental Review">
	<option value="20163 - MRC - Pioneer Valley Mountain Bike Trails">
	<option value="20165 - FKG CIVIL Creek Crossing Ecology Surveys">
	<option value="20168 - Mulgrave Central Mill Particulate Matter Monitoring">
	<option value="20169 - Stupkin ACM">
	<option value="20172 - Mt Morgan Rail Trail">
	<option value="20173 - GRC EMP Carpark Agnes Water">
	<option value="20175 - Nerimbera Slipway survey">
	<option value="20177 - FSC Precinct B and C">
	<option value="20xxx - Tunuba Stanage Bay Road weed management">
	<option value="21001 - Flexihire">
	<option value="21002 - CREST Assured Rockhampton Ring Road">
	<option value="21007 - Loftus Contracting - Pre Clearance Vegetation Survey">
	<option value="21009 - BSC Waste Approvals">
	<option value="21011 - Spiegelhauer Rd - Road Sealing Project">
	<option value="21022 - Banana Shire Council PFAS KP">
	<option value="21026 - Bellequip Ecological Clearance">
	<option value="21030 - Clarke Creek Weed Spraying">
	<option value="21033 - Shamrock Civil Secondment">
	<option value="21036 - Fulton Hogan Walkerston Bypass">
	<option value="21041 - ASMTI Weed Management">
	<option value="21044 - Sunwater Ecology Rookwood Weir">
	<option value="21048 - ArcGIS Field Maps">
	<option value="21049 - AMSA">
	<option value="21052 - ORICA Reid Road ESC Assessment">
	<option value="21054 - Western Street">
	<option value="21055 - CHRC Test Pitting">
	<option value="21058 - Upper Stoney Creek">
	<option value="21060 - DSDILGP">
	<option value="21061 - QMAG Fauna Spotter Catcher">
	<option value="21070 - JRT Asbestos Soil">
	<option value="21072 - Gladstone Cattle Dip PSI_DSDILGP">
	<option value="21076 - Wulguru Steel Due Diligence">
	<option value="21082 - NBRC - Waste Support">
	<option value="21083 - JRT Solagen">
	<option value="21086 - Crokers Fuel Contam Land">
	<option value="21088 - Hutchicson Builders Noise Monitoring">
	<option value="21091 - Shamrock North South Road">
	<option value="21101 - Remondis Red Rover Road">
	<option value="21106 - Glencore Mt Isa Ecology Assessment">
	<option value="21114 - Gracemere FOGO">
	<option value="21115 - Whitson and Dawson PSI">
	<option value="21118 - RMS FSC">
	<option value="21121 - DL Waste Solutions Zebra Metals Sampling">
	<option value="21121 - Langford Contaminated Land">
	<option value="21129 - Greening Australia Closed Landfill Study">
	<option value="21137 - Mt Panorama Extractive Industry">
	<option value="21139 - BMD Rocky Airport">
	<option value="21148 - GAWB_Gladstone to Fitzroy Pipeline Project">
	<option value="21149 - Remondis Soil Assessment Mt Isa">
	<option value="21153 - Aurizon Jilalan">
	<option value="21154 - McCoskers Alpha HPA PPF ESCP">
	<option value="21155 - Omega Chemical ACH Manufacturing Plant Project">
	<option value="21156 - Zone Planning Agnes Veg">
	<option value="21164 - Vision Proserpine EIA">
	<option value="21166 - Hutchinson QAS">
	<option value="21174 - Learning Pro">
	<option value="22016 - Remondis Rio Smelter KGS Landfill Waste Classification">
	<option value="22021 - MSL Algae Management">
	<option value="22022 - Brisbane Flood Cleanup">
	<option value="22028 - M Shaw Veg Assessment">
	<option value="22034 - Olympic Village Proposal">
	<option value="22036 - Woollam River Street">
	<option value="22037 - LCRL Environmental Data">
	<option value="22040 - Alder Constructions Frenchmans Bay Stair Upgrade">
	<option value="22043 - RRC Gracemere Landfill Soil Classification">
	<option value="22045 - TMR Weed Identification Survey">
	<option value="22047 - Portion of regional ecosystems in Study Area">
	<option value="22048 - GRC Pipe Bridge Removal">
	<option value="22049 - Aherns CEMP">
	<option value="22050 - Wetland Assessment">
	<option value="22055 - Liberty Industrial - AMSA Weed Treatment">
	<option value="22056 - RRC - Sewer Treatment Plant Soil Assessment">
	<option value="22059 - Sweers Island">
	<option value="22060 - Remondis MCU Planning Zone">
	<option value="22070 - Sunwater Mackenzie River Crossing Spoil Contamination Assessment">
	<option value="22077 - Longreach and Blackall STP Compliance Assessment">
	<option value="22080 - Dileigh - Russel Park Road Desktop Assessment">
	<option value="22083 - Mt. Chalmers Noise Assessment">
	<option value="22089 - Shamrock Civil Samueal Airfield Ecological Investigation">
	<option value="22092 - CMC Rockhampton Yeppoon Rd Environmental Support">
	<option value="22100 - Yaamba Flora and Fauna Surveys">
	<option value="22104 - RRC McMillan Ave - Potential ACM Sampling">
	<option value="22107 - Diesel Spill Sampling">
	<option value="22117 - Mt Rawdon EA - Evolution">
	<option value="22126 - Marine Plant Survey">
	<option value="22127 - Archibald St Contaminated Land">
	<option value="22128 - Ingenia Due Diligence">
	<option value="22129 - QLD Hydro Pioneer-Burdekin Borumba">
	<option value="22131 - Aurizon Weed Survey Coppabella">
	<option value="22132 - CAD Desktop Assessment">
	<option value="22133 - Clarke Creek Wind Farm">
	<option value="22140 - Glencore Hale Creek">
	<option value="22xxx - Enviro Support">
	<option value="23004 - National Interpretation Australia Project">
	<option value="23008 - Powerlink Proserpine Windfarm corridor options">
	<option value="23013 - BT Builders RRR FSC">
	<option value="23016 - Saraji Mine Groundwater Monitoring">
	<option value="23022 - MBJV Weed Spraying">
	<option value="23030 - Downer Weed Management">
	<option value="23037 - Eungella Flora Survey">
	<option value="23038 - TMR Boonal Depositional Dust Monitoring">
	<option value="23042 - Mt Hopeful">
	<option value="23044 - Santa Barbara Parade Development">
	<option value="23046 - Pumpkin Island">
	<option value="23048 - CSQ EA and Offsets">
	<option value="23050 - Neoen Clearing Supervision">
	<option value="23051 - Qld Nitrate Pond Evaporation Study">
	<option value="23056 - Veolia Landfill Environmental Monitoring">
	<option value="23057 - MBJV Gladstone Pipeline FSC Tunuba">
	<option value="23061 - Isis Central Sugar Mill">
	<option value="23062 - Sunwater monitoring Program">
	<option value="23063 - Greening Aus Eco">
	<option value="23064 - Greening Aus secondment">
	<option value="23070 - Stamnore GIS Support">
	<option value="23074 - Soda Ash Market overview">
	<option value="23079 - LIFE Tinpot PMAV">
	<option value="23080 - TSL New Bridge Development">
	<option value="23090 - Colosseum PMAV">
	<option value="23091 - Squadron Energy">
	<option value="23093 - Redimix Spill Remediation Sampling">
	<option value="23095 - GMR Transport Mackay">
	<option value="23096 - Rookwood Weir Gauging Stations">
	<option value="23098 - Origin Brine Pond Assessment">
	<option value="23100 -">
	<option value="23100 - Mount Maria Ecology">
	<option value="23102 - TPG Desktop Assesment">
	<option value="23103 - Mount Vince Rifle Range Soil Sampling">
	<option value="23104 - Endeavour Foundation ERA62">
	<option value="23107 - CHRC - CHRC Soil and Water">
	<option value="23108 - ORICA ESC Assessment">
	<option value="23109 - Lowmead Vegetation Clearance">
	<option value="23110 - Bolder Creek Wind Farm">
	<option value="23114 - Magnetic South FSC">
	<option value="23117 - Mardie Project - Approvals for Airstrip">
	<option value="23120 - Origin MCH Gladstone Stakeholder">
	<option value="23123 - Omega Boron Street">
	<option value="23127 - Pre clearance area">
	<option value="23129 - Telstra InfaCo Contaminated Land">
	<option value="23130 - QH PHES DAR Phase Contaminated Land">
	<option value="23144 - Magnetic South FSC">
	<option value="24000 - FGP Weed spraying">
	<option value="24002 - Whitehave Coal">
	<option value="24004 - BEW Opworks">
	<option value="24010 - Stanwell Power Station Env Support">
	<option value="24021 - Squadron Energy FSC">
	<option value="24022 - NQ Spark JCU Campus">
	<option value="24025 - QBuild Soil Assessment">
	<option value="24029 - Stantec WBTA Enviro Services">
	<option value="24034 - GAWB Water Sampling Fitzroy River and Awoonga Dam">
	<option value="24037 - Rosella Park School Fencing">
	<option value="24038 - Westside weed surveys and management plan">
	<option value="24042 - Geology">
	<option value="24042 - QPWS - Ecological Assessment of Clarke Range Walking Track">
	<option value="24047 - Clearing Impact Area">
	<option value="24048 - Stantec HV Ecology assessment">
	<option value="24057 - GAWB Pipeline Ecology Assessment">
	<option value="24061 - United Petroleum ESA Yeppoon Proposal">
	<option value="24065 - Shoal Point Beach Access">
	<option value="24073 - FBA Six Mile Creek Planting">
	<option value="24077 - Moah Ck Wind farm - Koala at Kalapa">
	<option value="24078 - Eurimbula Elements Green">
	<option value="24080 - Quinbrook MV Solar and BESS">
	<option value="24087 - Blackwater PFAS Soil Sampling">
	<option value="24096 - Sarina Distillery - Biodunder Pipeline System - Risk Assessment">
	<option value="24111 - PSA">
	<option value="24113 - European Energy Upper Calliope">
	<option value="24121 - GAWB Aquaculture Gladstone REMP">
	<option value="24127 - CIVEO Phase 1 Enviro">
	<option value="24128 - New Project No info yet">
	<option value="24129 - BCWF">
	<option value="24131 - GAWB STNA Vegetation">
	<option value="24134 - GRC Waste Audit">
	<option value="24137 - Water Monitoring Program">
	<option value="24138 - DTI Boulder Creek Wind Farm">
	<option value="24144 - Roadtek Vegetation Clearing Works">
	<option value="24152 - QVC Proposed Quarry">
	<option value="24155 - BCWF Glider Survey">
	<option value="25002P - Windfarm Theodore - Biloela 20250123">
	<option value="25007 - Powerlink Bouldercombe - Larcom Creek Corridor Selection">
	<option value="25011 - Blackall Wool Plan">
	<option value="25018 - Townsville Flood Recovery">
	<option value="25019 - GRC Env Mgmt and Monitoring">
	<option value="25022- Glencoe Substation Water Quality Monitoring Program">
	<option value="25026 - Brisbane - Cyclone Alfred Cleanup">
	<option value="25027 - GAWB-QAL DN600 Pipeline Replacement Detailed Design">
	<option value="25035 - FSC SWBTA">
	<option value="25037 - Wilmar Bowen Pipeline">
	<option value="25052 - Peak Downs Mine Road Breeding Place Survey">
	<option value="25056P - BSC Annual Volumetric Survey">
	<option value="25058P - MHWF Upgrade Road Corridor for Weed Survey">
	<option value="25060- GAWB LTNA Infrastructure and Approvals Assessment">
	<option value="25xxxP - Energy Estates Pipeline">
</datalist>

<label>Abtrac Task</label>
<input type="text" id="abtracTask" />

<div id="requestBlocks"></div>

<div id="addButtons">
  <button type="button" class="maroon-btn" onclick="addMapBlock()">Mapping (New)</button>
  <button type="button" class="maroon-btn" onclick="addMapUpdateBlock()">Mapping (Update)</button>
  <button type="button" class="maroon-btn" onclick="addAreaBlock()">Area Calculation</button>
  <button type="button" class="maroon-btn" onclick="addAnalysisBlock()">Other Analysis</button>
</div>

<div id="submitSection">
  <button onclick="generatePDF()">Download PDF</button>
  <a href="https://cqgrocky.sharepoint.com/:l:/s/GISTeam/FG1ek-oukMxNtQl-KYshjR4BT2FDgVqG9tOh42mKmwfPqw?nav=MGNhM2IyMDQtNDJmMy00MDM3LWI3YmUtYWQzMzkzM2I4Njdm" target="_blank">
    <button>Submit Request</button>
  </a>
</div>

<script>
function scrollToButtons() {
  document.getElementById("addButtons").scrollIntoView({ behavior: "smooth" });
}

function addMapBlock() {
  const div = document.createElement("div");
  div.className = "section";
  div.innerHTML = `
    <h4>Mapping (New)</h4>
    <div style="display:flex;gap:10px;align-items:end;">
      <div style="flex:1;">
        <label><a href="https://github.com/akcharith/gis-request-form/blob/main/sample.png?raw=true" target="_blank" style="text-decoration: none; color: black;">Figure Number <span style="color: #0078d4;">- See sample image for details</span></a></label>
        <input type="text">
      </div>
      <div style="flex:2;">
        <label>Map Title (Figure Title)</label>
        <input type="text">
      </div>
      <div style="flex:1;">
        <label>Client</label>
        <input type="text">
      </div>
      <div style="flex:2;">
        <label>Report Title</label>
        <input type="text">
      </div>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <div style="flex:1;">
        <label>Basemap</label>
        <select>
          <option>Google Satellite Imagery</option>
          <option>ArcGIS World Imagery</option>
          <option>None</option>
          <option>Other (Please specify below)</option>
        </select>
      </div>
      <div style="flex:2;">
        <label>Standard Layers</label>
        <div class="inline-checkboxes">
          <label><input type="checkbox" class="layer" checked> Roads</label>
          <label><input type="checkbox" class="layer" checked> Cadastral Boundaries</label>
          <label><input type="checkbox" class="layer"> Waterways</label>
          <label><input type="checkbox" class="layer"> Place Names</label>
          <label><input type="checkbox" class="layer"> RE Mapping</label>
          <label><input type="checkbox" class="layer"> Regulated Vegetation (VMA)</label>
          <label><input type="checkbox" class="layer"> Essential Habitat</label>
          <label><input type="checkbox" class="layer"> Protected Plant Trigger Areas</label>
        </div>
      </div>
    </div>
    <label style="margin-top:10px;">Other Layers/ Required Extent/ Other Instructions</label>
    <textarea rows="10"></textarea>
    <div style="margin-top:10px; display:flex; gap:10px;">
      <button type="button" class="delete-btn" onclick="this.parentElement.parentElement.remove()">Delete Block</button>
    </div>
  `;
  document.getElementById("requestBlocks").appendChild(div);
  scrollToButtons();
}
function addMapUpdateBlock() {
  const div = document.createElement("div");
  div.className = "section";
  div.innerHTML = `
    <h4>Mapping (Update)</h4>
    <label><a href="https://github.com/akcharith/gis-request-form/blob/main/sample.png?raw=true" target="_blank" style="text-decoration: none; color: black;">CQG Map Number (e.g. 25007-02-14) <span style="color: #0078d4;">- See sample image for details</span></a></label>
    <input type="text" />
    <label>Instructions</label>
    <textarea rows="10"></textarea>
    <div style="margin-top:10px; display:flex; gap:10px;">
      <button type="button" class="delete-btn" onclick="this.parentElement.parentElement.remove()">Delete Block</button>
    </div>
  `;
  document.getElementById("requestBlocks").appendChild(div);
  scrollToButtons();
}
function addAreaBlock() {
  const count = document.querySelectorAll(".section h4").length;
  const div = document.createElement("div");
  div.className = "section";
  div.innerHTML = `
    <h4>Area Calculation</h4>
    <label>Instructions</label>
    <textarea rows="10"></textarea>
    <button type="button" class="delete-btn" onclick="this.parentElement.remove()">Delete Block</button>
  `;
  document.getElementById("requestBlocks").appendChild(div);
  scrollToButtons();
}
function addAnalysisBlock() {
  const count = document.querySelectorAll(".section h4").length;
  const div = document.createElement("div");
  div.className = "section";
  div.innerHTML = `
    <h4>Other Analysis</h4>
    <label>Instructions</label>
    <textarea rows="10"></textarea>
    <button type="button" class="delete-btn" onclick="this.parentElement.remove()">Delete Block</button>
  `;
  document.getElementById("requestBlocks").appendChild(div);
  scrollToButtons();
}
function generatePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ orientation: "landscape", unit: "mm", format: "a4" });
  doc.setFontSize(14);
  doc.setFont(undefined, 'bold');
  doc.text("CQG GIS Request Form", 148, 15, { align: "center" });

  const projectName = document.getElementById("ranList").value || "";
  const abtracTask = document.getElementById("abtracTask").value || "";

  doc.setFontSize(11);
  doc.setFont(undefined, 'bold');
  doc.text(`Project: ${projectName}`, 10, 25);
  doc.text(`Abtrac Task: ${abtracTask}`, 10, 32);

  let startY = 40;

  function drawSingleColumnTable(title, entries) {
    if (entries.length === 0) return;
    entries.forEach((block, index) => {
      if (startY > 180) {
        doc.addPage();
        startY = 20;
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.text("CQG GIS Request Form", 148, 15, { align: "center" });
      }
      doc.setFontSize(11);
      doc.setFont(undefined, 'normal');
      doc.text(title + (entries.length > 1 ? ` ${index + 1}` : ""), 10, startY);
      startY += 6;

      block.forEach(([label, content]) => {
        const lines = doc.splitTextToSize(content, 240);
        const height = lines.length * 6;
        if (startY + height > 190) {
          doc.addPage();
          startY = 20;
          doc.setFontSize(11);
          doc.setFont(undefined, 'bold');
          doc.text("CQG GIS Request Form", 148, 15, { align: "center" });
          doc.setFontSize(11);
        }
        doc.rect(10, startY, 37, height);
        doc.setFont(undefined, 'bold');
        doc.text(label, 12, startY + 5);
        doc.setFont(undefined, 'normal');
        doc.rect(47, startY, 240, height);
        if (label.toLowerCase().includes("instruction") && /^https?:\/\/\S+$/i.test(content.trim())) {
			doc.setTextColor(0, 102, 204);
			doc.textWithLink(content.trim(), 49, startY + 5, { url: content.trim() });
			doc.setTextColor(0, 0, 0);
		  } else {
			doc.text(lines, 49, startY + 5);
		  }
        startY += height;
      });

      startY += 10;
    });
  }

  const mapBlocks = [], mapUpdateBlocks = [], areaBlocks = [], analysisBlocks = [];
  document.querySelectorAll("#requestBlocks .section").forEach((section) => {
    const title = section.querySelector("h4")?.innerText || "";
    const textareas = section.querySelectorAll("textarea");
    const inputs = section.querySelectorAll("input[type='text']");
    const selects = section.querySelectorAll("select");
    const layers = Array.from(section.querySelectorAll("input.layer:checked")).map(cb => cb.parentElement.innerText.trim()).join(", ");

    if (title.includes("Mapping (New)")) {
      mapBlocks.push([
        ["Figure Number", inputs[0]?.value || ""],
        ["Client", inputs[1]?.value || ""],
        ["Report Title", inputs[2]?.value || ""],
        ["Map Title", inputs[3]?.value || ""],
        ["Basemap", selects[0]?.value || ""],
        ["Standard Layers", layers],
        ["Other Instructions", textareas[0]?.value || ""]
      ]);
    } else if (title.includes("Mapping (Update)")) {
      mapUpdateBlocks.push([
        ["CQG Map Number", inputs[0]?.value || ""],
        ["Instructions", textareas[0]?.value || ""]
      ]);
    } else if (title.includes("Area Calculation")) {
      areaBlocks.push([["Instructions", textareas[0]?.value || ""]]);
    } else if (title.includes("Other Analysis")) {
      analysisBlocks.push([["Instructions", textareas[0]?.value || ""]]);
    }
  });

  drawSingleColumnTable("Mapping (New)", mapBlocks);
  drawSingleColumnTable("Mapping (Update)", mapUpdateBlocks);
  drawSingleColumnTable("Area Calculation", areaBlocks);
  drawSingleColumnTable("Other Analysis", analysisBlocks);

  doc.save("CQG_GIS_Request_Form.pdf");
}
</script>
</body>
</html>
